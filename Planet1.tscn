[gd_scene load_steps=8 format=2]

[ext_resource path="res://Player.gd" type="Script" id=1]
[ext_resource path="res://FollowPlayerRotation.gd" type="Script" id=2]
[ext_resource path="res://skybox/Epic_BlueSunset_EquiRect_flat.png" type="Texture" id=3]

[sub_resource type="GDScript" id=1]
script/source = "extends Spatial

onready var map = get_node('/root/WorldModelGenerator')
var player;
var camera_origin;

# Called when the node enters the scene tree for the first time.
func _ready():
	map.initWorld();
	player = get_child(0);
	camera_origin = get_child(1);
	update_player_position()


func _input(ev):
	#if (ev is InputEventMouseButton and ev.is_pressed()):
	#	map.move_player(Vector2(+1,0))
	#	player.translation = map.get_player_world_position()
	#	print('Player moved:',player.translation)
	if(ev is InputEventKey):
		if Input.is_action_pressed(\"ui_right\"):
			map.move_player(\"right\")
			
		if Input.is_action_pressed(\"ui_left\"):
			map.move_player(\"left\")
			
		if Input.is_action_pressed(\"ui_up\"):
			map.move_player(\"up\")
			
		if Input.is_action_pressed(\"ui_down\"):
			map.move_player(\"down\")

		update_player_position()
		print('Player moved:',player.translation)

func update_player_position():
	player.translation = map.get_player_world_position()

"

[sub_resource type="PanoramaSky" id=3]
radiance_size = 3
panorama = ExtResource( 3 )

[sub_resource type="Environment" id=4]
background_mode = 2
background_sky = SubResource( 3 )
background_sky_custom_fov = 94.4

[sub_resource type="SpatialMaterial" id=2]
albedo_color = Color( 1, 0, 0, 0.211765 )
roughness = 0.18
roughness_texture_channel = 1

[node name="Space" type="Spatial"]

[node name="World" type="Spatial" parent="."]
transform = Transform( 0.995324, 0, 0, 0, 0.995324, 0, 0, 0, 0.995324, 0, 0, 0 )
script = SubResource( 1 )

[node name="Player" type="Spatial" parent="World"]
transform = Transform( 1.0047, 0, 0, 0, 1.0047, 0, 0, 0, 1.0047, 0, 10.5493, 0 )
script = ExtResource( 1 )

[node name="CSGBox" type="CSGBox" parent="World/Player"]
transform = Transform( 1.0008, 0, 0, 0, 1.0008, 0, 0, 0, 1.0008, 0, 0, 0 )
width = 1.0
height = 1.0
depth = 1.0

[node name="Camera Origin" type="Spatial" parent="World"]
transform = Transform( 0.000583728, -0.824453, -0.574189, 0.710361, 0.406389, -0.582795, 0.710495, -0.405636, 0.583157, 0, 0, 0 )
script = ExtResource( 2 )

[node name="Camera" type="Camera" parent="World/Camera Origin"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0325737, -0.103939, 150.075 )
environment = SubResource( 4 )
projection = 1
fov = 20.3
size = 40.0
near = 2.92
far = 8192.0

[node name="Shape" type="CSGBox" parent="World"]
width = 19.0
height = 19.0
depth = 19.0
material = SubResource( 2 )

[node name="Tween" type="Tween" parent="World"]
